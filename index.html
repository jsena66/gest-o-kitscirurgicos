<!DOCTYPE html>
    <html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Plataforma de Gestão Cirúrgica v8.0 - Aprimorada por Manus</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <style>
            /* Estilos gerais e para componentes da UI */
            body { font-family: 'Inter', sans-serif; }
            .sidebar-icon { width: 24px; height: 24px; }
            .modal-backdrop {
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background-color: rgba(0, 0, 0, 0.6 ); z-index: 40;
                backdrop-filter: blur(4px);
            }
            .modal {
                position: fixed; top: 50%; left: 50%;
                transform: translate(-50%, -50%); z-index: 50;
                max-height: 90vh;
            }
            .toast {
                position: fixed; bottom: 20px; right: 20px; z-index: 100;
                transition: opacity 0.5s, transform 0.5s;
            }
            .loader {
                border-top-color: #3498db;
                animation: spin 1s linear infinite;
            }
            @keyframes spin { to { transform: rotate(360deg); } }
            /* Animação para entrada de modais */
            @keyframes fadeIn { from { opacity: 0; transform: translate(-50%, -45%); } to { opacity: 1; transform: translate(-50%, -50%); } }
            .modal-fade-in { animation: fadeIn 0.3s ease-out forwards; }
            /* Scrollbar customizada */
            ::-webkit-scrollbar { width: 8px; }
            ::-webkit-scrollbar-track { background: #f1f1f1; }
            ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
            ::-webkit-scrollbar-thumb:hover { background: #555; }
        </style>
    </head>
    <body class="bg-gray-100 antialiased">
    
        <!-- Loader inicial da aplicação -->
        <div id="app-loader" class="fixed inset-0 bg-white flex items-center justify-center z-[100]">
            <div class="text-center">
                <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-32 w-32 mx-auto"></div>
                <p class="mt-4 text-lg text-gray-600">Carregando plataforma...</p>
            </div>
        </div>
    
        <div class="flex h-screen">
            <!-- Barra Lateral de Navegação -->
            <aside class="w-64 bg-gray-800 text-white flex flex-col flex-shrink-0">
                <div class="h-16 flex items-center justify-center text-2xl font-bold border-b border-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-2 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" /></svg>
                    GestãoCir
                </div>
                <nav id="sidebar-nav" class="flex-1 px-4 py-6 space-y-2"></nav>
                <div class="p-4 border-t border-gray-700">
                    <div class="text-sm font-medium">Usuário: Dr. Alan</div>
                    <div class="text-xs text-gray-400">Administrador</div>
                </div>
            </aside>
    
            <!-- Conteúdo Principal -->
            <main id="main-content" class="flex-1 p-8 overflow-y-auto bg-gray-50"></main>
        </div>
    
        <!-- Contêiner para Modais e Notificações -->
        <div id="modal-container"></div>
        <div id="toast-container"></div>
    
        <script type="module">
            // ===================================================================================
            // --- MÓDULO 1: GESTÃO DE ESTADO E PERSISTÊNCIA ---
            // ===================================================================================
            let state = {
                currentPage: 'dashboard',
                products: [],
                suppliers: [],
                clients: [],
                kits: [],
                stockLots: [],
                surgeries: [],
                currentUser: { name: 'Dr. Alan', role: 'admin' },
                // Dados de exemplo para popular a aplicação
                initialData: {
                    products: [
                        { id: 'P001', name: 'Placa de Titânio 2.0mm', description: 'Placa para fixação óssea', costPrice: 150.00, sellPrice: 350.00, needsSerialNumber: true, supplierId: 'S01' },
                        { id: 'P002', name: 'Parafuso de Titânio 2.0x8mm', description: 'Parafuso para fixação de placas', costPrice: 25.00, sellPrice: 60.00, needsSerialNumber: true, supplierId: 'S01' },
                        { id: 'P003', name: 'Gaze Estéril (Pacote c/ 100)', description: 'Material de consumo para curativos', costPrice: 15.00, sellPrice: 30.00, needsSerialNumber: false, supplierId: 'S02' },
                        { id: 'P004', name: 'Fio de Sutura Nylon 3-0', description: 'Fio cirúrgico não absorvível', costPrice: 8.00, sellPrice: 20.00, needsSerialNumber: false, supplierId: 'S02' },
                    ],
                    suppliers: [
                        { id: 'S01', name: 'Titanium Medical', contact: 'contato@titaniumed.com' },
                        { id: 'S02', name: 'Suture & Co.', contact: 'vendas@sutureco.com' },
                    ],
                    clients: [
                        { id: 'C01', name: 'Hospital Central', address: 'Rua das Flores, 123' },
                        { id: 'C02', name: 'Clínica Ortopédica Sul', address: 'Av. Principal, 456' },
                    ],
                    kits: [
                        {
                            id: 'K01',
                            name: 'Kit Básico de Osteossíntese',
                            products: [
                                { productId: 'P001', quantity: 2 },
                                { productId: 'P002', quantity: 8 },
                                { productId: 'P003', quantity: 1 },
                            ]
                        }
                    ],
                    stockLots: [
                        // Lotes para P001 (Placa)
                        { id: 'L001', productId: 'P001', serialNumber: 'SN-A1B2C3D4', quantity: 1, initialQuantity: 1, entryDate: '2023-10-01' },
                        { id: 'L002', productId: 'P001', serialNumber: 'SN-A1B2C3D5', quantity: 1, initialQuantity: 1, entryDate: '2023-10-01' },
                        { id: 'L003', productId: 'P001', serialNumber: 'SN-A1B2C3D6', quantity: 1, initialQuantity: 1, entryDate: '2023-10-01' },
                        // Lotes para P002 (Parafuso)
                        { id: 'L004', productId: 'P002', serialNumber: 'SN-X9Y8Z7W6', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        { id: 'L005', productId: 'P002', serialNumber: 'SN-X9Y8Z7W7', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        { id: 'L006', productId: 'P002', serialNumber: 'SN-X9Y8Z7W8', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        { id: 'L007', productId: 'P002', serialNumber: 'SN-X9Y8Z7W9', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        { id: 'L008', productId: 'P002', serialNumber: 'SN-X9Y8Z7W0', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        { id: 'L009', productId: 'P002', serialNumber: 'SN-X9Y8Z7W1', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        { id: 'L010', productId: 'P002', serialNumber: 'SN-X9Y8Z7W2', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        { id: 'L011', productId: 'P002', serialNumber: 'SN-X9Y8Z7W3', quantity: 1, initialQuantity: 1, entryDate: '2023-10-02' },
                        // Lote para P003 (Gaze) - Sem número de série, controle por lote
                        { id: 'L012', productId: 'P003', serialNumber: 'BATCH-GZ-001', quantity: 50, initialQuantity: 50, entryDate: '2023-09-25' },
                        // Lote para P004 (Fio de Sutura)
                        { id: 'L013', productId: 'P004', serialNumber: 'BATCH-FS-001', quantity: 100, initialQuantity: 100, entryDate: '2023-09-20' },
                    ],
                    surgeries: [
                        {
                            id: 'C-2023-001',
                            patientName: 'Carlos Silva',
                            hospitalId: 'C01',
                            date: '2023-10-28',
                            status: 'Agendada',
                            requiredMaterials: [
                                { productId: 'P001', quantity: 1 },
                                { productId: 'P002', quantity: 4 },
                                { productId: 'P003', quantity: 1 },
                                { productId: 'P004', quantity: 2 },
                            ],
                            separatedMaterials: [],
                            usedMaterials: [],
                            returnedMaterials: []
                        }
                    ]
                }
            };

            // Função para salvar o estado no localStorage
            const saveState = () => {
                try {
                    const stateToSave = { ...state };
                    // Não salvamos os dados iniciais para não sobreescrever o estado modificado
                    delete stateToSave.initialData;
                    localStorage.setItem('surgicalManagementState', JSON.stringify(stateToSave));
                } catch (e) {
                    console.error("Erro ao salvar o estado:", e);
                }
            };

            // Função para carregar o estado do localStorage
            const loadState = () => {
                try {
                    const savedState = localStorage.getItem('surgicalManagementState');
                    if (savedState) {
                        return JSON.parse(savedState);
                    } else {
                        // Se não houver estado salvo, inicializa com os dados de exemplo
                        const initialState = { ...state, ...state.initialData };
                        delete initialState.initialData;
                        return initialState;
                    }
                } catch (e) {
                    console.error("Erro ao carregar o estado:", e);
                    // Em caso de erro, retorna o estado inicial padrão
                    const initialState = { ...state, ...state.initialData };
                    delete initialState.initialData;
                    return initialState;
                }
            };

            // Inicializa o estado da aplicação
            state = loadState();

            // ===================================================================================
            // --- MÓDULO 2: UTILITÁRIOS E HELPERS ---
            // ===================================================================================
            const utils = {
                // Gera um ID único simples
                generateId: (prefix) => `${prefix}-${Date.now()}-${Math.random().toString(36).substr(2, 5)}`,

                // Formata data para o padrão brasileiro
                formatDate: (dateString) => {
                    if (!dateString) return 'N/A';
                    const [year, month, day] = dateString.split('-');
                    return `${day}/${month}/${year}`;
                },

                // Formata valores monetários
                formatCurrency: (value) => `R$ ${Number(value).toFixed(2).replace('.', ',')}`,

                // Converte a primeira letra para maiúscula
                capitalize: (s) => s.charAt(0).toUpperCase() + s.slice(1),

                // Obtém o nome de um item (produto, cliente, etc.) pelo seu ID
                getNameById: (type, id) => {
                    const item = state[type]?.find(i => i.id === id);
                    return item ? item.name : 'Não encontrado';
                },
            };

            // ===================================================================================
            // --- MÓDULO 3: RENDERIZAÇÃO DA UI E COMPONENTES ---
            // ===================================================================================
            const ui = {
                // Função principal de renderização que atualiza o conteúdo da página
                render() {
                    this.renderSidebar();
                    this.renderPageContent();
                    saveState(); // Salva o estado a cada renderização
                },

                // Renderiza a barra de navegação lateral
                renderSidebar() {
                    const navEl = document.getElementById('sidebar-nav');
                    const navItems = [
                        { id: 'dashboard', label: 'Dashboard', icon: 'M9 17v-2a4 4 0 00-4-4H3V9h2a4 4 0 004-4V3l5 4-5 4v-2a2 2 0 01-2-2h-1v2h1a2 2 0 012 2v2l5 4-5 4z' },
                        { id: 'surgeries', label: 'Cirurgias', icon: 'M3 7h18M3 12h18M3 17h18' },
                        { id: 'stock', label: 'Estoque', icon: 'M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4' },
                        { id: 'registrations', label: 'Cadastros', icon: 'M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z' },
                    ];

                    navEl.innerHTML = navItems.map(item => `
                        <a href="#" 
                           class="flex items-center px-4 py-3 text-sm font-medium rounded-md transition-colors duration-200 
                                  ${state.currentPage === item.id ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-700 hover:text-white'}"
                           onclick="navigate('${item.id}')">
                            <svg class="sidebar-icon mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${item.icon}"></path></svg>
                            ${item.label}
                        </a>
                    `).join('');
                },

                // Direciona a renderização para a página correta com base no estado
                renderPageContent() {
                    const mainContent = document.getElementById('main-content');
                    switch (state.currentPage) {
                        case 'dashboard': mainContent.innerHTML = this.renderDashboard(); break;
                        case 'surgeries': mainContent.innerHTML = this.renderSurgeriesPage(); break;
                        case 'stock': mainContent.innerHTML = this.renderStockPage(); break;
                        case 'registrations': mainContent.innerHTML = this.renderRegistrationsPage(); break;
                        default: mainContent.innerHTML = `<h1 class="text-2xl font-bold">Página não encontrada</h1>`;
                    }
                },

                // --- Funções de Geração de Componentes Reutilizáveis ---
                createCard(title, content, footer, iconPath) {
                    return `
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <div class="flex items-center">
                                <svg class="h-8 w-8 text-blue-500 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${iconPath}"></path></svg>
                                <div>
                                    <h3 class="text-gray-500 text-sm font-medium">${title}</h3>
                                    <p class="text-2xl font-bold text-gray-800">${content}</p>
                                </div>
                            </div>
                            ${footer ? `<div class="mt-4 text-sm text-gray-500">${footer}</div>` : ''}
                        </div>
                    `;
                },

                createButton(text, action, type = 'primary') { type = 'primary') {
                    const colors = {
                        blue: 'bg-blue-600 hover:bg-blue-700',
                        green: 'bg-green-600 hover:bg-green-700',
                        red: 'bg-red-600 hover:bg-red-700',
                        gray: 'bg-gray-500 hover:bg-gray-600',
                    };
                    const icon = iconPath ? `<svg class="h-5 w-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="${iconPath}" clip-rule="evenodd" /></svg>` : '';
                    return `
                        <button onclick="${action}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${colors[color]} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${color}-500 transition-transform transform hover:scale-105">
                            ${icon}
                            ${text}
                        </button>
                    `;
                },

                createTable(headers, rows) {
                    return `
                        <div class="overflow-x-auto bg-white rounded-lg shadow">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        ${headers.map(h => `<th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">${h}</th>`).join('')}
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    ${rows.length > 0 ? rows.join('') : `<tr><td colspan="${headers.length}" class="px-6 py-4 text-center text-gray-500">Nenhum dado disponível.</td></tr>`}
                                </tbody>
                            </table>
                        </div>
                    `;
                },

                createModal(title, content, actions, modalId = 'generic-modal') {
                    const modalContainer = document.getElementById('modal-container');
                    modalContainer.innerHTML = `
                        <div id="${modalId}-backdrop" class="modal-backdrop"></div>
                        <div id="${modalId}" class="modal bg-white w-full max-w-2xl rounded-lg shadow-xl overflow-hidden modal-fade-in">
                            <div class="flex justify-between items-center p-5 bg-gray-100 border-b">
                                <h2 class="text-xl font-semibold text-gray-800">${title}</h2>
                                <button onclick="ui.closeModal('${modalId}')" class="text-gray-400 hover:text-gray-600">&times;</button>
                            </div>
                            <div class="p-6 overflow-y-auto">${content}</div>
                            <div class="flex justify-end p-4 bg-gray-50 border-t space-x-3">${actions}</div>
                        </div>
                    `;
                },

                closeModal(modalId = 'generic-modal') {
                    const modal = document.getElementById(modalId);
                    const backdrop = document.getElementById(`${modalId}-backdrop`);
                    if (modal && backdrop) {
                        modal.remove();
                        backdrop.remove();
                    }
                },

                showToast(message, type = 'info') {
                    const colors = {
                        success: 'bg-green-500',
                        error: 'bg-red-500',
                        info: 'bg-blue-500',
                    };
                    const toastId = `toast-${Date.now()}`;
                    const toastContainer = document.getElementById('toast-container');
                    const toastEl = document.createElement('div');
                    toastEl.id = toastId;
                    toastEl.className = `toast text-white px-6 py-4 rounded-md shadow-lg ${colors[type]} opacity-0 transform translate-y-4`;
                    toastEl.innerText = message;
                    toastContainer.appendChild(toastEl);

                    // Animação de entrada
                    setTimeout(() => {
                        toastEl.classList.remove('opacity-0', 'translate-y-4');
                        toastEl.classList.add('opacity-100', 'translate-y-0');
                    }, 10);

                    // Desaparecer após 3 segundos
                    setTimeout(() => {
                        toastEl.classList.add('opacity-0');
                        toastEl.addEventListener('transitionend', () => toastEl.remove());
                    }, 3000);
                },

                // --- Funções de Renderização de Páginas Específicas ---
                renderDashboard() {
                    const upcomingSurgeries = state.surgeries.filter(s => new Date(s.date) >= new Date() && s.status === 'Agendada').length;
                    const pendingSeparation = state.surgeries.filter(s => s.status === 'Agendada').length;
                    const lowStockItems = state.stockLots.filter(l => l.quantity < 5).length;

                    return `
                        <h1 class="text-3xl font-bold text-gray-800 mb-6">Dashboard</h1>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${this.createCard('Cirurgias Agendadas', state.surgeries.length, `${upcomingSurgeries} nos próximos 30 dias`, 'M3 7h18M3 12h18M3 17h18')}
                            ${this.createCard('Separações Pendentes', pendingSeparation, 'Prontas para iniciar', 'M12 6v6m0 0v6m0-6h6m-6 0H6')}
                            ${this.createCard('Itens em Baixo Estoque', lowStockItems, 'Necessário reposição', 'M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z')}
                        </div>
                        <div class="mt-8">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">Atividade Recente</h2>
                            ${this.createTable(
                                ['Data', 'Paciente', 'Hospital', 'Status'],
                                state.surgeries.slice(-5).reverse().map(s => `
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${utils.formatDate(s.date)}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${s.patientName}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${utils.getNameById('clients', s.hospitalId)}</td>
                                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${this.getStatusBadge(s.status)}">${s.status}</span></td>
                                    </tr>
                                `)
                            )}
                        </div>
                    `;
                },

                renderSurgeriesPage() {
                    const headers = ['ID', 'Paciente', 'Hospital', 'Data', 'Status', 'Ações'];
                    const rows = state.surgeries.map(s => `
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${s.id}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">${s.patientName}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${utils.getNameById('clients', s.hospitalId)}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${utils.formatDate(s.date)}</td>
                            <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${this.getStatusBadge(s.status)}">${s.status}</span></td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                ${s.status === 'Agendada' ? this.createButton('Separar', `showSeparationModal('${s.id}')`, 'blue') : ''}
                                ${s.status === 'Em Separação' ? this.createButton('Recolher', `showCollectionModal('${s.id}')`, 'green') : ''}
                                ${s.status !== 'Finalizada' ? this.createButton('Cancelar', `cancelSurgery('${s.id}')`, 'red') : ''}
                            </td>
                        </tr>
                    `);

                    return `
                        <div class="flex justify-between items-center mb-6">
                            <h1 class="text-3xl font-bold text-gray-800">Gerenciamento de Cirurgias</h1>
                            ${this.createButton('Agendar Nova Cirurgia', 'showSurgeryModal()', 'blue', 'M12 6v6m0 0v6m0-6h6m-6 0H6')}
                        </div>
                        ${this.createTable(headers, rows)}
                    `;
                },

                renderStockPage() {
                    const headers = ['Produto', 'Lote/Série', 'Quantidade', 'Data de Entrada', 'Fornecedor'];
                    const rows = state.stockLots.filter(l => l.quantity > 0).map(l => {
                        const product = state.products.find(p => p.id === l.productId);
                        return `
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${product ? product.name : 'Produto não encontrado'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono">${l.serialNumber}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">${l.quantity} / ${l.initialQuantity}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${utils.formatDate(l.entryDate)}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${utils.getNameById('suppliers', product?.supplierId)}</td>
                            </tr>
                        `;
                    });

                    return `
                        <div class="flex justify-between items-center mb-6">
                            <h1 class="text-3xl font-bold text-gray-800">Controle de Estoque</h1>
                            ${this.createButton('Dar Entrada em Lote', 'showStockEntryModal()', 'green', 'M12 9v3m0 0v3m0-3h3m-3 0H9m12-3a9 9 0 11-18 0 9 9 0 0118 0z')}
                        </div>
                        ${this.createTable(headers, rows)}
                    `;
                },

                renderRegistrationsPage() {
                    const registrationTypes = ['products', 'kits', 'clients', 'suppliers'];
                    return `
                        <h1 class="text-3xl font-bold text-gray-800 mb-6">Cadastros Gerais</h1>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            ${registrationTypes.map(type => `
                                <div>
                                    <div class="flex justify-between items-center mb-4">
                                        <h2 class="text-2xl font-semibold text-gray-700">${utils.capitalize(type === 'clients' ? 'Clientes' : type === 'suppliers' ? 'Fornecedores' : type === 'kits' ? 'Kits Cirúrgicos' : 'Produtos')}</h2>
                                        ${this.createButton(`Novo ${utils.capitalize(type).slice(0, -1)}`, `showRegistrationModal('${type}')`, 'blue')}
                                    </div>
                                    <div class="bg-white p-4 rounded-lg shadow max-h-96 overflow-y-auto">
                                        ${this.renderRegistrationList(type)}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                },

                renderRegistrationList(type) {
                    if (!state[type] || state[type].length === 0) {
                        return `<p class="text-gray-500 text-center py-4">Nenhum item cadastrado.</p>`;
                    }
                    return `
                        <ul class="divide-y divide-gray-200">
                            ${state[type].map(item => `
                                <li class="py-3 flex justify-between items-center">
                                    <span class="font-medium text-gray-800">${item.name}</span>
                                    <div class="space-x-2">
                                        <button onclick="showRegistrationModal('${type}', '${item.id}')" class="text-blue-500 hover:text-blue-700">Editar</button>
                                        <button onclick="deleteRegistrationItem('${type}', '${item.id}')" class="text-red-500 hover:text-red-700">Excluir</button>
                                    </div>
                                </li>
                            `).join('')}
                        </ul>
                    `;
                },

                getStatusBadge(status) {
                    switch (status) {
                        case 'Agendada': return 'bg-blue-100 text-blue-800';
                        case 'Em Separação': return 'bg-yellow-100 text-yellow-800';
                        case 'Em Andamento': return 'bg-indigo-100 text-indigo-800';
                        case 'Finalizada': return 'bg-green-100 text-green-800';
                        case 'Cancelada': return 'bg-red-100 text-red-800';
                        default: return 'bg-gray-100 text-gray-800';
                    }
                },
            };

            // ===================================================================================
            // --- MÓDULO 4: LÓGICA DE NEGÓCIO E MANIPULAÇÃO DE DADOS ---
            // ===================================================================================
            
            // --- Funções de Navegação ---
            window.navigate = (page) => {
                state.currentPage = page;
                ui.render();
            };

            // --- Funções de Cirurgia ---
            window.showSurgeryModal = (id = null) => {
                // Lógica para mostrar modal de agendamento de cirurgia
                const content = `
                    <div class="space-y-4">
                        ${createFormInput('patientName', 'Nome do Paciente', 'text', 'Obrigatório')}
                        ${createFormSelect('hospitalId', 'Hospital', state.clients.map(c => ({value: c.id, text: c.name})))}
                        ${createFormInput('date', 'Data da Cirurgia', 'date')}
                        <div>
                            <h4 class="font-medium text-gray-700 mb-2">Materiais Necessários</h4>
                            <div id="materials-list" class="space-y-2"></div>
                            <div class="flex items-center space-x-2 mt-2">
                                ${createFormSelect('material-select', 'Adicionar Material', state.products.map(p => ({value: p.id, text: p.name})), false)}
                                ${createFormInput('material-qty', 'Qtd', 'number', '1', 'w-20')}
                                <button onclick="addMaterialToSurgery()" class="bg-gray-200 hover:bg-gray-300 px-3 py-2 rounded-md text-sm">Adicionar</button>
                            </div>
                        </div>
                    </div>
                `;
                const actions = ui.createButton('Salvar Agendamento', 'saveSurgery()', 'green');
                ui.createModal('Agendar Nova Cirurgia', content, actions, 'surgery-modal');
                window.tempMaterials = []; // Armazena materiais temporariamente
            };

            window.addMaterialToSurgery = () => {
                const productId = document.getElementById('material-select').value;
                const quantity = parseInt(document.getElementById('material-qty').value, 10);
                if (!productId || !quantity || quantity < 1) {
                    ui.showToast('Selecione um material e uma quantidade válida.', 'error');
                    return;
                }
                const product = state.products.find(p => p.id === productId);
                // Adiciona ou atualiza a quantidade
                const existingMaterial = tempMaterials.find(m => m.productId === productId);
                if (existingMaterial) {
                    existingMaterial.quantity += quantity;
                } else {
                    tempMaterials.push({ productId, quantity, name: product.name });
                }
                renderTempMaterialsList();
            };

            window.removeTempMaterial = (productId) => {
                tempMaterials = tempMaterials.filter(m => m.productId !== productId);
                renderTempMaterialsList();
            };

            window.renderTempMaterialsList = () => {
                const listEl = document.getElementById('materials-list');
                if (tempMaterials.length === 0) {
                    listEl.innerHTML = `<p class="text-sm text-gray-500">Nenhum material adicionado.</p>`;
                } else {
                    listEl.innerHTML = tempMaterials.map(m => `
                        <div class="flex justify-between items-center bg-gray-100 p-2 rounded-md">
                            <span>${m.name} (Qtd: ${m.quantity})</span>
                            <button onclick="removeTempMaterial('${m.productId}')" class="text-red-500 hover:text-red-700 font-bold">&times;</button>
                        </div>
                    `).join('');
                }
            };

            window.saveSurgery = () => {
                const patientName = document.getElementById('patientName').value;
                const hospitalId = document.getElementById('hospitalId').value;
                const date = document.getElementById('date').value;

                if (!patientName || !hospitalId || !date || tempMaterials.length === 0) {
                    ui.showToast('Preencha todos os campos e adicione ao menos um material.', 'error');
                    return;
                }

                const newSurgery = {
                    id: utils.generateId('C'),
                    patientName,
                    hospitalId,
                    date,
                    status: 'Agendada',
                    requiredMaterials: [...tempMaterials],
                    separatedMaterials: [],
                    usedMaterials: [],
                    returnedMaterials: []
                };

                state.surgeries.push(newSurgery);
                ui.closeModal('surgery-modal');
                ui.showToast('Cirurgia agendada com sucesso!', 'success');
                ui.render();
            };

            window.cancelSurgery = (id) => {
                if (!confirm('Tem certeza que deseja cancelar esta cirurgia? Esta ação não pode ser desfeita.')) return;
                const surgery = state.surgeries.find(s => s.id === id);
                if (surgery) {
                    surgery.status = 'Cancelada';
                    // Lógica para retornar materiais ao estoque, se aplicável
                    ui.showToast('Cirurgia cancelada.', 'info');
                    ui.render();
                } else {
                    ui.showToast('Cirurgia não encontrada.', 'error');
                }
            };

            // --- Funções de Separação e Recolhimento (BIPAR) ---
            window.showSeparationModal = (surgeryId) => {
                const surgery = state.surgeries.find(s => s.id === surgeryId);
                if (!surgery) return;

                // Marcar a cirurgia como 'Em Separação'
                if (surgery.status === 'Agendada') {
                    surgery.status = 'Em Separação';
                    ui.render(); // Atualiza a lista de cirurgias
                }

                const requiredList = surgery.requiredMaterials.map(mat => {
                    const separatedCount = surgery.separatedMaterials.filter(sm => sm.productId === mat.productId).length;
                    const needed = mat.quantity - separatedCount;
                    return `
                        <li class="flex justify-between items-center ${needed <= 0 ? 'text-gray-400 line-through' : 'text-gray-800'}">
                            <span>${utils.getNameById('products', mat.productId)}</span>
                            <span class="font-mono">${separatedCount} / ${mat.quantity}</span>
                        </li>
                    `;
                }).join('');

                const separatedList = surgery.separatedMaterials.map(mat => `
                    <li class="flex justify-between items-center bg-green-50 p-1 rounded">
                        <span>${utils.getNameById('products', mat.productId)}</span>
                        <span class="font-mono text-sm">${mat.serialNumber}</span>
                    </li>
                `).join('');

                const content = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="font-semibold text-lg mb-2">Materiais Necessários</h3>
                            <ul class="space-y-2">${requiredList}</ul>
                        </div>
                        <div>
                            <h3 class="font-semibold text-lg mb-2">Materiais Separados</h3>
                            <ul class="space-y-1 max-h-48 overflow-y-auto">${separatedList || '<li class="text-gray-500">Nenhum item bipado.</li>'}</ul>
                        </div>
                    </div>
                    <div class="mt-6">
                        <label for="bip-input" class="block text-sm font-medium text-gray-700">Bipar Material (Lote/Série)</label>
                        <input type="text" id="bip-input" onkeypress="handleBip(event, '${surgeryId}')" 
                               class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                               placeholder="Digite o código e pressione Enter">
                    </div>
                `;
                const actions = ui.createButton('Finalizar Separação', `finishSeparation('${surgeryId}')`, 'green');
                ui.createModal(`Separação para Cirurgia ${surgeryId}`, content, actions, 'separation-modal');
                document.getElementById('bip-input').focus();
            };

            window.handleBip = (event, surgeryId) => {
                if (event.key !== 'Enter') return;
                const input = event.target;
                const serialNumber = input.value.trim();
                if (!serialNumber) return;

                const surgery = state.surgeries.find(s => s.id === surgeryId);
                const stockLot = state.stockLots.find(l => l.serialNumber === serialNumber && l.quantity > 0);

                // 1. Validação: O item existe no estoque?
                if (!stockLot) {
                    ui.showToast(`Erro: Item com código '${serialNumber}' não encontrado no estoque.`, 'error');
                    input.value = '';
                    return;
                }

                const productId = stockLot.productId;
                const requiredMaterial = surgery.requiredMaterials.find(m => m.productId === productId);

                // 2. Validação: O item é necessário para esta cirurgia?
                if (!requiredMaterial) {
                    ui.showToast(`Aviso: O item '${utils.getNameById('products', productId)}' não é necessário para esta cirurgia.`, 'info');
                    input.value = '';
                    return;
                }

                // 3. Validação: A quantidade necessária já foi atingida?
                const alreadySeparatedCount = surgery.separatedMaterials.filter(m => m.productId === productId).length;
                if (alreadySeparatedCount >= requiredMaterial.quantity) {
                    ui.showToast(`Aviso: A quantidade necessária de '${utils.getNameById('products', productId)}' já foi separada.`, 'info');
                    input.value = '';
                    return;
                }

                // 4. Validação: Este item específico já foi bipado?
                if (surgery.separatedMaterials.some(m => m.serialNumber === serialNumber)) {
                    ui.showToast(`Aviso: O item com série '${serialNumber}' já foi bipado.`, 'info');
                    input.value = '';
                    return;
                }

                // Sucesso! Mover o item
                stockLot.quantity -= 1;
                surgery.separatedMaterials.push({ 
                    productId: stockLot.productId, 
                    serialNumber: stockLot.serialNumber,
                    lotId: stockLot.id
                });

                ui.showToast(`'${utils.getNameById('products', productId)}' adicionado com sucesso!`, 'success');
                input.value = '';
                
                // Re-renderiza o conteúdo do modal sem fechá-lo
                showSeparationModal(surgeryId);
                document.getElementById('bip-input').focus();
            };

            window.finishSeparation = (surgeryId) => {
                const surgery = state.surgeries.find(s => s.id === surgeryId);
                // Validação final: todos os itens foram separados?
                const allSeparated = surgery.requiredMaterials.every(req => {
                    const separatedCount = surgery.separatedMaterials.filter(sep => sep.productId === req.productId).length;
                    return separatedCount >= req.quantity;
                });

                if (!allSeparated) {
                    if (!confirm('Atenção: Nem todos os materiais foram separados. Deseja continuar e finalizar a separação mesmo assim?')) {
                        return;
                    }
                }

                surgery.status = 'Em Andamento'; // Ou 'Aguardando Recolhimento'
                ui.closeModal('separation-modal');
                ui.showToast('Separação finalizada. Cirurgia pronta para o próximo estágio.', 'success');
                ui.render();
            };

            window.showCollectionModal = (surgeryId) => {
                // Similar à separação, mas para registrar o que foi usado e o que foi devolvido
                // Esta é uma implementação simplificada para demonstração
                const surgery = state.surgeries.find(s => s.id === surgeryId);
                if (!surgery) return;

                const separatedItemsHtml = surgery.separatedMaterials.map(mat => `
                    <div class="flex items-center justify-between p-2 bg-gray-100 rounded-md">
                        <span>${utils.getNameById('products', mat.productId)} (${mat.serialNumber})</span>
                        <div class="flex items-center space-x-2">
                            <label class="text-sm">Usado:</label>
                            <input type="checkbox" id="used-${mat.lotId}" class="h-4 w-4 text-indigo-600 border-gray-300 rounded">
                        </div>
                    </div>
                `).join('');

                const content = `
                    <p class="mb-4">Marque os itens que foram utilizados na cirurgia. Os itens não marcados serão automaticamente retornados ao estoque.</p>
                    <div class="space-y-2">${separatedItemsHtml}</div>
                `;
                const actions = ui.createButton('Finalizar Recolhimento', `finishCollection('${surgeryId}')`, 'green');
                ui.createModal(`Recolhimento da Cirurgia ${surgeryId}`, content, actions, 'collection-modal');
            };

            window.finishCollection = (surgeryId) => {
                const surgery = state.surgeries.find(s => s.id === surgeryId);
                if (!surgery) return;

                surgery.separatedMaterials.forEach(mat => {
                    const isUsed = document.getElementById(`used-${mat.lotId}`).checked;
                    if (isUsed) {
                        surgery.usedMaterials.push(mat);
                    } else {
                        surgery.returnedMaterials.push(mat);
                        // Devolve ao estoque
                        const stockLot = state.stockLots.find(l => l.id === mat.lotId);
                        if (stockLot) {
                            stockLot.quantity += 1;
                        }
                    }
                });

                surgery.status = 'Finalizada';
                surgery.separatedMaterials = []; // Limpa a lista de separados

                ui.closeModal('collection-modal');
                ui.showToast('Recolhimento finalizado e estoque atualizado!', 'success');
                ui.render();
            };

            // --- Funções de Cadastro (CRUD Genérico) ---
            window.showRegistrationModal = (type, id = null) => {
                const isEditing = id !== null;
                const item = isEditing ? state[type].find(i => i.id === id) : {};
                const title = `${isEditing ? 'Editar' : 'Novo'} ${utils.capitalize(type).slice(0, -1)}`;
                let content = '';

                // Gerador de formulário dinâmico
                switch (type) {
                    case 'products':
                        content = `
                            <div class="space-y-4">
                                ${createFormInput('name', 'Nome do Produto', 'text', 'Nome...', item.name)}
                                ${createFormInput('description', 'Descrição', 'text', 'Descrição...', item.description)}
                                <div class="grid grid-cols-2 gap-4">
                                    ${createFormInput('costPrice', 'Preço de Custo', 'number', '0.00', item.costPrice)}
                                    ${createFormInput('sellPrice', 'Preço de Venda', 'number', '0.00', item.sellPrice)}
                                </div>
                                ${createFormSelect('supplierId', 'Fornecedor', state.suppliers.map(s => ({value: s.id, text: s.name})), item.supplierId)}
                                ${createFormCheckbox('needsSerialNumber', 'Requer Número de Série?', item.needsSerialNumber)}
                            </div>
                        `;
                        break;
                    case 'kits':
                        // A criação/edição de kits é mais complexa e pode ter um modal dedicado
                        content = createKitForm(item);
                        break;
                    case 'clients':
                        content = `
                            <div class="space-y-4">
                                ${createFormInput('name', 'Nome do Cliente/Hospital', 'text', 'Nome...', item.name)}
                                ${createFormInput('address', 'Endereço', 'text', 'Endereço...', item.address)}
                            </div>
                        `;
                        break;
                    case 'suppliers':
                        content = `
                            <div class="space-y-4">
                                ${createFormInput('name', 'Nome do Fornecedor', 'text', 'Nome...', item.name)}
                                ${createFormInput('contact', 'Contato (email/tel)', 'text', 'Contato...', item.contact)}
                            </div>
                        `;
                        break;
                }

                const actionButton = ui.createButton('Salvar', `saveRegistrationItem('${type}', '${id}')`, 'green');
                ui.createModal(title, content, actionButton, 'registration-modal');
                if (type === 'kits') renderTempKitProducts(item.products || []);
            };

            window.saveRegistrationItem = (type, id) => {
                const isEditing = id !== 'null';
                let item = isEditing ? state[type].find(i => i.id === id) : { id: utils.generateId(type.charAt(0).toUpperCase()) };

                // Coleta de dados do formulário
                switch (type) {
                    case 'products':
                        item.name = document.getElementById('name').value;
                        item.description = document.getElementById('description').value;
                        item.costPrice = parseFloat(document.getElementById('costPrice').value);
                        item.sellPrice = parseFloat(document.getElementById('sellPrice').value);
                        item.supplierId = document.getElementById('supplierId').value;
                        item.needsSerialNumber = document.getElementById('needsSerialNumber').checked;
                        break;
                    case 'kits':
                        item.name = document.getElementById('kit-name').value;
                        item.products = [...window.tempKitProducts]; // Usa a lista temporária de produtos do kit
                        break;
                    case 'clients':
                        item.name = document.getElementById('name').value;
                        item.address = document.getElementById('address').value;
                        break;
                    case 'suppliers':
                        item.name = document.getElementById('name').value;
                        item.contact = document.getElementById('contact').value;
                        break;
                }

                // Validação simples
                if (!item.name) {
                    ui.showToast('O campo nome é obrigatório.', 'error');
                    return;
                }

                if (isEditing) {
                    const index = state[type].findIndex(i => i.id === id);
                    state[type][index] = item;
                } else {
                    state[type].push(item);
                }

                ui.closeModal('registration-modal');
                ui.showToast(`Item salvo com sucesso!`, 'success');
                ui.render();
            };

            window.deleteRegistrationItem = (type, id) => {
                if (!confirm(`Tem certeza que deseja excluir este item?`)) return;
                state[type] = state[type].filter(i => i.id !== id);
                // Adicionar lógica para verificar dependências antes de excluir
                ui.showToast('Item excluído.', 'info');
                ui.render();
            };

            // --- Funções Auxiliares para Formulários ---
            window.createFormInput = (id, label, type, placeholder = '', value = '', containerClass = '') => {
                return `
                    <div class="${containerClass}">
                        <label for="${id}" class="block text-sm font-medium text-gray-700">${label}</label>
                        <input type="${type}" id="${id}" value="${value || ''}" placeholder="${placeholder}" 
                               class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                `;
            };

            window.createFormSelect = (id, label, options, selectedValue = '', includeLabel = true) => {
                const labelHtml = includeLabel ? `<label for="${id}" class="block text-sm font-medium text-gray-700">${label}</label>` : '';
                return `
                    <div>
                        ${labelHtml}
                        <select id="${id}" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                            <option value="">Selecione...</option>
                            ${options.map(opt => `<option value="${opt.value}" ${opt.value === selectedValue ? 'selected' : ''}>${opt.text}</option>`).join('')}
                        </select>
                    </div>
                `;
            };

            window.createFormCheckbox = (id, label, checked = false) => {
                return `
                    <div class="flex items-center">
                        <input id="${id}" type="checkbox" ${checked ? 'checked' : ''} class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        <label for="${id}" class="ml-2 block text-sm text-gray-900">${label}</label>
                    </div>
                `;
            };

            // --- Funções Específicas para o Formulário de Kits ---
            window.createKitForm = (kit) => {
                window.tempKitProducts = kit.products ? [...kit.products] : [];
                return `
                    <div class="space-y-4">
                        ${createFormInput('kit-name', 'Nome do Kit', 'text', 'Ex: Kit de Artroscopia', kit.name)}
                        <div>
                            <h4 class="font-medium text-gray-700 mb-2">Produtos no Kit</h4>
                            <div id="kit-products-list" class="space-y-2 border p-2 rounded-md min-h-[50px]"></div>
                            <div class="flex items-end space-x-2 mt-2">
                                <div class="flex-grow">
                                    ${createFormSelect('kit-product-select', 'Adicionar Produto', state.products.map(p => ({value: p.id, text: p.name})), '', false)}
                                </div>
                                <div class="w-24">
                                    ${createFormInput('kit-product-qty', 'Qtd', 'number', '1')}
                                </div>
                                <button type="button" onclick="addProductToKit()" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 text-sm">Adicionar</button>
                            </div>
                        </div>
                    </div>
                `;
            };

            window.addProductToKit = () => {
                const productId = document.getElementById('kit-product-select').value;
                const quantity = parseInt(document.getElementById('kit-product-qty').value, 10);
                if (!productId || !quantity || quantity < 1) {
                    ui.showToast('Selecione um produto e quantidade válida.', 'error');
                    return;
                }
                const existing = tempKitProducts.find(p => p.productId === productId);
                if (existing) {
                    existing.quantity += quantity;
                } else {
                    tempKitProducts.push({ productId, quantity });
                }
                renderTempKitProducts(tempKitProducts);
            };

            window.removeProductFromKit = (productId) => {
                tempKitProducts = tempKitProducts.filter(p => p.productId !== productId);
                renderTempKitProducts(tempKitProducts);
            };

            window.renderTempKitProducts = (products) => {
                const listEl = document.getElementById('kit-products-list');
                if (!products || products.length === 0) {
                    listEl.innerHTML = `<p class="text-sm text-gray-500 text-center">Nenhum produto no kit.</p>`;
                } else {
                    listEl.innerHTML = products.map(p => {
                        const productName = utils.getNameById('products', p.productId);
                        return `
                            <div class="flex justify-between items-center bg-gray-100 p-2 rounded-md">
                                <span>${productName} (Qtd: ${p.quantity})</span>
                                <button type="button" onclick="removeProductFromKit('${p.productId}')" class="text-red-500 hover:text-red-700 font-bold">&times;</button>
                            </div>
                        `;
                    }).join('');
                }
            };

            // --- Funções de Estoque ---
            window.showStockEntryModal = () => {
                const content = `
                    <div class="space-y-4">
                        ${createFormSelect('productId', 'Produto', state.products.map(p => ({value: p.id, text: p.name})))}
                        ${createFormInput('serialNumber', 'Lote / Número de Série', 'text', 'SN-XXXX ou LOTE-YYYY')}
                        ${createFormInput('quantity', 'Quantidade', 'number', '1')}
                        ${createFormInput('entryDate', 'Data de Entrada', 'date', '', new Date().toISOString().split('T')[0])}
                    </div>
                `;
                const actions = ui.createButton('Adicionar ao Estoque', 'saveStockEntry()', 'green');
                ui.createModal('Entrada de Novo Lote/Item', content, actions, 'stock-entry-modal');
            };

            window.saveStockEntry = () => {
                const productId = document.getElementById('productId').value;
                const serialNumber = document.getElementById('serialNumber').value;
                const quantity = parseInt(document.getElementById('quantity').value, 10);
                const entryDate = document.getElementById('entryDate').value;

                if (!productId || !serialNumber || !quantity || !entryDate) {
                    ui.showToast('Todos os campos são obrigatórios.', 'error');
                    return;
                }

                const product = state.products.find(p => p.id === productId);
                if (product.needsSerialNumber && quantity > 1) {
                    if (!confirm('Este produto requer número de série individual. Ao adicionar uma quantidade maior que 1, você está criando múltiplos itens com números de série sequenciais (ex: SN-001, SN-002). Deseja continuar?')) {
                        return;
                    }
                    // Lógica para criar múltiplos itens seriais
                    for (let i = 0; i < quantity; i++) {
                        const newLot = {
                            id: utils.generateId('L'),
                            productId,
                            serialNumber: `${serialNumber}-${i + 1}`,
                            quantity: 1,
                            initialQuantity: 1,
                            entryDate
                        };
                        state.stockLots.push(newLot);
                    }
                } else {
                    // Adiciona como um único lote (ou item serial)
                    const newLot = {
                        id: utils.generateId('L'),
                        productId,
                        serialNumber,
                        quantity,
                        initialQuantity: quantity,
                        entryDate
                    };
                    state.stockLots.push(newLot);
                }

                ui.closeModal('stock-entry-modal');
                ui.showToast('Estoque atualizado com sucesso!', 'success');
                if (state.currentPage === 'stock') {
                    ui.render();
                }
            };

            // ===================================================================================
            // --- MÓDULO 5: INICIALIZAÇÃO DA APLICAÇÃO ---
            // ===================================================================================
            document.addEventListener('DOMContentLoaded', () => {
                const appLoader = document.getElementById('app-loader');
                // Simula um tempo de carregamento para exibir o loader
                setTimeout(() => {
                    ui.render();
                    appLoader.style.display = 'none';
                }, 500); // Meio segundo de loader
            });

        </script>
    </body>
    </html>


